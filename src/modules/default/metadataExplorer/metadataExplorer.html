<template>
  <div class="slds-p-around_medium slds-text-color_default">
    <lightning-card title="Metadata Explorer">
      <template lwc:if={metadataTypeOptions}>
        <lightning-combobox
          name="selectedMetadataType"
          label="Select Metadata Type"
          value={selectedMetadataType}
          options={metadataTypeOptions}
          onchange={handleMetadataTypeSelection}
          onsort={updateColumnSorting}
          class="slds-m-around_medium"
        ></lightning-combobox>
      </template>
      <template lwc:if={renderRetrieve}>
        <lightning-button
          label="Retrieve"
          slot="actions"
          onclick={handleRetrieveClick}
        ></lightning-button>
      </template>
      <template lwc:if={sortedMetadataOfSelectedType}>
        <div style="height: 300px" class="slds-m-around_medium">
          <lightning-datatable
            key-field="fullName"
            data={sortedMetadataOfSelectedType}
            columns={columns}
            sorted-by={sortedBy}
            onsort={updateColumnSorting}
            onrowselection={handleRowSelection}
          >
          </lightning-datatable>
        </div>
      </template>
      <template lwc:if={orgConnectionInfo}>
        <div slot="footer">
          <p>URL: {orgConnectionInfo.result.instanceUrl}</p>
          <p>username: {orgConnectionInfo.result.username}</p>
          <p>orgName: {orgConnectionInfo.result.orgName}</p>
          <p>edition: {orgConnectionInfo.result.edition}</p>
        </div>
      </template>
    </lightning-card>

    <template lwc:if={error}>
      <div class="slds-p-around_medium">
        <p>Error:</p>
        <pre class="slds-box slds-text-font_monospace">{error}</pre>
      </div>
    </template>

    <template lwc:if={showSpinner}>
      <lightning-spinner
        alternative-text="Loading"
        size="medium"
      ></lightning-spinner>
    </template>
  </div>
</template>
